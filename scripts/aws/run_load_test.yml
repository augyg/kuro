# Runs the AWS Kadena load test

- name: Run Load Test
  hosts: localhost
  vars:
    total: 12000
    size: 1000   
  tasks:
    - name: Make Bolosim Executable
      file:
        path: /home/ubuntu/kadena-beta/bin/ubuntu-16.04/bolosim
        mode: a+x

    - name: Run Bolosim Test
      command: rlwrap -A /home/ubuntu/kadena-beta/bin/ubuntu-16.04/bolosim --transactions={{ total }}  --batchsize={{ size }} --norunserver --configfile=client.yaml --dirforconfig=/home/ubuntu/conf/
      args:
        chdir: /home/ubuntu/kadena
      register: result

    - name: Write Result of Bolosim Load Test to File
      copy: content={{ result.stdout }} dest=/home/ubuntu/result.log
